# 修复主程序等待扫描完成的问题计划

## 问题分析
- 错误现象：kb_scan和kb_scan_report可能没有运行完成就被中断
- 根本原因：kb_scan_thread被设置为守护线程，主程序退出时会自动终止线程

## 解决方案
修改vm_management_workflow.py文件，确保主程序等待kb_scan线程完成后再退出

## 具体步骤

### 步骤1：修改upgrade_kb_packages方法
- 移除kb_scan_thread.daemon = True设置，使线程成为非守护线程
- 或者在方法结束前添加kb_scan_thread.join()等待线程完成

### 步骤2：修改run_workflow方法
- 确保在工作流结束前，所有子线程都已完成

## 预期结果
- 主程序会等待KB扫描和报告生成完成后再退出
- kb_scan和kb_scan_report能够正常运行完成
- 不再出现扫描过程被中断的情况
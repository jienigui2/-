## 编码问题分析

### 当前环境编码情况
1. **系统活动代码页**: 936 (GBK编码)
2. **Python默认编码**: utf-8
3. **文件系统编码**: utf-8
4. **区域设置编码**: cp936 (GBK编码)
5. **peizhi.py文件编码**: UTF-8 (无BOM)

### 编码不匹配问题
1. **系统与Python编码不一致**: 系统使用GBK，Python使用UTF-8
2. **subprocess输出解码**: Web端运行时，subprocess捕获的字节流需要正确解码
3. **字符串处理**: 中文字符在不同编码间转换可能出现问题
4. **文件读写**: 配置文件和日志文件的编码处理

## 编码处理改进方案

### 1. 确保文件编码正确
- **peizhi.py文件**: 添加明确的编码声明
- **其他Python文件**: 检查并确保使用UTF-8编码
- **配置文件**: 确保使用UTF-8编码保存和读取

### 2. 改进字符串编码处理
- **标准输出处理**: 确保print语句的输出编码正确
- **subprocess输出解码**: 优化字节流解码逻辑
- **文件读写编码**: 明确指定文件读写时的编码

### 3. 环境编码适配
- **添加编码检测**: 检测系统编码并适配
- **编码转换**: 在关键位置添加编码转换逻辑
- **错误处理**: 增强编码错误的处理机制

### 4. 具体修改点

#### peizhi.py文件
1. **文件开头**: 添加编码声明
2. **print语句**: 确保中文字符正确输出
3. **文件读写**: 明确指定编码
4. **错误处理**: 增强编码相关的错误处理

#### config_web.py文件
1. **subprocess输出解码**: 改进字节流解码逻辑
2. **日志文件**: 明确指定编码
3. **环境检测**: 添加系统编码检测

#### 其他文件
1. **配置文件处理**: 确保使用UTF-8编码
2. **日志输出**: 统一编码处理

## 预期效果

1. **解决编码不匹配问题**: 确保中文字符在不同环境下都能正确显示
2. **提高系统兼容性**: 适应不同的系统编码设置
3. **增强错误处理**: 更好地处理编码相关的异常
4. **统一编码标准**: 在整个项目中使用一致的编码标准